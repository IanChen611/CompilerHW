# HW3 æª”æ¡ˆèªªæ˜

æœ¬æ–‡ä»¶èªªæ˜ HW3 ä¸­å„å€‹æª”æ¡ˆçš„ç”¨é€”åŠå…¶å°æ‡‰çš„é¡Œç›®ã€‚
---
æ­¤ä»½ä½œæ¥­å‰ä¸‰é¡Œç”±æˆ‘çœ‹ä½œæ¥­ç¿»è­¯å¾Œå¯«å®Œ
ä½†æˆ‘ç¬¬å››é¡Œåˆ°ç¬¬å…­é¡Œæœ‰ä½¿ç”¨claude code
---

## ğŸ“ ä¸»è¦å¯¦ä½œæ–‡ä»¶

### `Parser.ml`
**å°æ‡‰é¡Œç›®ï¼šç¬¬ 1~6 é¡Œï¼ˆå®Œæ•´å¯¦ä½œï¼‰**

é€™æ˜¯æœ€æ ¸å¿ƒçš„æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰é¡Œç›®çš„è§£ç­”ï¼š

#### ç¬¬ 1 é¡Œ - `null` å‡½æ•¸ (è¡Œ 13-28)
- **åŠŸèƒ½**ï¼šåˆ¤æ–·æ­£å‰‡è¡¨é”å¼æ˜¯å¦æ¥å—ç©ºå­—ä¸² (epsilon)
- **å¯¦ä½œé‡é»**ï¼š
  - `Epsilon` â†’ `true`
  - `Character` â†’ `false`
  - `Union` â†’ åªè¦æœ‰ä¸€å€‹æ¥å—å°±æ˜¯ `true`
  - `Concat` â†’ å…©å€‹éƒ½è¦æ¥å—æ‰æ˜¯ `true`
  - `Star` â†’ ä¸€å®šæ˜¯ `true`ï¼ˆå¯ä»¥åŒ¹é… 0 æ¬¡ï¼‰

#### ç¬¬ 2 é¡Œ - `first` å’Œ `last` å‡½æ•¸ (è¡Œ 31-62)
- **åŠŸèƒ½**ï¼š
  - `first`: è¨ˆç®—å¯èƒ½çš„é¦–å­—ç¬¦é›†åˆ
  - `last`: è¨ˆç®—å¯èƒ½çš„å°¾å­—ç¬¦é›†åˆ
- **ä½¿ç”¨**ï¼šé€™å…©å€‹å‡½æ•¸æ˜¯æ§‹å»º DFA çš„åŸºç¤

#### ç¬¬ 3 é¡Œ - `follow` å‡½æ•¸ (è¡Œ 67-93)
- **åŠŸèƒ½**ï¼šè¨ˆç®—åœ¨æ­£å‰‡è¡¨é”å¼ä¸­ï¼Œå“ªäº›å­—ç¬¦å¯ä»¥è·Ÿéš¨åœ¨çµ¦å®šå­—ç¬¦ `c` å¾Œé¢
- **é‡é»**ï¼š
  - `Concat(r1, r2)`: å¦‚æœ `c âˆˆ last(r1)`ï¼Œå‰‡ `first(r2)` çš„å­—ç¬¦å¯ä»¥è·Ÿéš¨
  - `Star(r1)`: å¦‚æœ `c âˆˆ last(r1)`ï¼Œå‰‡ `first(r1)` çš„å­—ç¬¦å¯ä»¥è·Ÿéš¨ï¼ˆå¾ªç’°ï¼‰

#### ç¬¬ 4 é¡Œ - DFA è‡ªå‹•æ©Ÿæ§‹å»º (è¡Œ 154-251)
- **é¡å‹å®šç¾©** (è¡Œ 154-164):
  - `state`: ç‹€æ…‹æ˜¯å­—ç¬¦é›†åˆ
  - `autom`: è‡ªå‹•æ©Ÿçµæ§‹ï¼ŒåŒ…å«èµ·å§‹ç‹€æ…‹å’Œè½‰ç§»è¡¨
  - `Cmap`, `Smap`: å­—ç¬¦å’Œç‹€æ…‹çš„ Map

- **`next_state` å‡½æ•¸** (è¡Œ 168-175):
  - è¨ˆç®—å¾ç‹€æ…‹ `q` è®€å–å­—ç¬¦ `c` å¾Œçš„ä¸‹ä¸€å€‹ç‹€æ…‹

- **`make_dfa` å‡½æ•¸** (è¡Œ 178-221):
  - å¾æ­£å‰‡è¡¨é”å¼æ§‹å»ºå®Œæ•´çš„ DFA
  - ä½¿ç”¨æ·±åº¦å„ªå…ˆæœç´¢éæ­·æ‰€æœ‰å¯é”ç‹€æ…‹

- **å¯è¦–åŒ–å‡½æ•¸** (è¡Œ 220-251):
  - `fprint_state`: æ ¼å¼åŒ–è¼¸å‡ºç‹€æ…‹
  - `fprint_transition`: æ ¼å¼åŒ–è¼¸å‡ºè½‰ç§»
  - `fprint_autom`: ç”Ÿæˆ Graphviz dot æ ¼å¼
  - `save_autom`: ä¿å­˜åˆ°æ–‡ä»¶

#### ç¬¬ 5 é¡Œ - `recognize` å‡½æ•¸ (è¡Œ 254-273)
- **åŠŸèƒ½**ï¼šåˆ¤æ–·å­—ä¸²æ˜¯å¦è¢«è‡ªå‹•æ©Ÿæ¥å—
- **å¯¦ä½œ**ï¼šæ¨¡æ“¬ DFA é‹è¡Œï¼Œé€å­—ç¬¦è®€å–ä¸¦è½‰ç§»ç‹€æ…‹

#### ç¬¬ 6 é¡Œ - `generate` å‡½æ•¸ (è¡Œ 348-470)
- **åŠŸèƒ½**ï¼šç”Ÿæˆ OCaml è©æ³•åˆ†æå™¨ä»£ç¢¼
- **ç”Ÿæˆå…§å®¹**ï¼š
  - `buffer` é¡å‹å®šç¾©
  - `next_char` å‡½æ•¸
  - æ¯å€‹ç‹€æ…‹å°æ‡‰çš„ `stateN` å‡½æ•¸
  - `start` èµ·å§‹ç‹€æ…‹

---

## ğŸ§ª æ¸¬è©¦ç›¸é—œæ–‡ä»¶

### `test_null()`, `test_first()`, `test_last()`, `test_follow()` (Parser.ml è¡Œ 96-149)
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 1~3 é¡Œ
- **å…§å®¹**ï¼šé©—è­‰ `null`, `first`, `last`, `follow` å‡½æ•¸çš„æ­£ç¢ºæ€§

### `test_make_dfa()` (Parser.ml è¡Œ 276-287)
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 4 é¡Œ
- **æ¸¬è©¦è¡¨é”å¼**ï¼š`(a|b)*a(a|b)` - å€’æ•¸ç¬¬äºŒå€‹å­—ç¬¦æ˜¯ a çš„å­—ä¸²
- **è¼¸å‡º**ï¼š`autom.dot` æ–‡ä»¶

### `test_recognize()` (Parser.ml è¡Œ 290-316)
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 5 é¡Œ
- **æ¸¬è©¦è¡¨é”å¼**ï¼š`(a|b)*a(a|b)`
- **æ¸¬è©¦å…§å®¹**ï¼š
  - æ­£é¢æ¸¬è©¦ï¼š`"aa"`, `"ab"`, `"abababaab"`, `"babababab"`, 1000å€‹b+`"ab"`
  - è² é¢æ¸¬è©¦ï¼š`""`, `"a"`, `"b"`, `"ba"`, `"aba"`, `"abababaaba"`

### `test_recognize2()` (Parser.ml è¡Œ 319-343)
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 5 é¡Œ
- **æ¸¬è©¦è¡¨é”å¼**ï¼šå¶æ•¸å€‹ b çš„æ­£å‰‡è¡¨é”å¼
- **è¼¸å‡º**ï¼š`autom2.dot` æ–‡ä»¶

### `test_generate()` (Parser.ml è¡Œ 427-431)
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6.1 é¡Œ
- **æ¸¬è©¦è¡¨é”å¼**ï¼š`a*b`
- **è¼¸å‡º**ï¼š`a.ml` - è‡ªå‹•ç”Ÿæˆçš„è©æ³•åˆ†æå™¨

---

## ğŸ“Š è‡ªå‹•æ©Ÿå¯è¦–åŒ–æ–‡ä»¶

### `autom.dot` + `autom.pdf`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 4 é¡Œ
- **å…§å®¹**ï¼š`(a|b)*a(a|b)` çš„ DFA åœ–å½¢
- **ç”Ÿæˆæ–¹å¼**ï¼š
  ```bash
  wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml Parser.ml"
  wsl bash -c "cd /mnt/f/CompilerHW/HW3 && dot -Tpdf autom.dot > autom.pdf"
  ```
- **ç‰¹é»**ï¼š
  - çŸ©å½¢ç¯€é»ï¼šèµ·å§‹ç‹€æ…‹
  - æ©¢åœ“ç¯€é»ï¼šæ™®é€šç‹€æ…‹
  - åŒ…å« `#` çš„ç‹€æ…‹ï¼šæ¥å—ç‹€æ…‹
  - ç©ºæ©¢åœ“ï¼šçµ‚æ­¢ç‹€æ…‹

### `autom2.dot` + `autom2.pdf`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 5 é¡Œ
- **å…§å®¹**ï¼šå¶æ•¸å€‹ b çš„æ­£å‰‡è¡¨é”å¼çš„ DFA åœ–å½¢
- **ç”Ÿæˆæ–¹å¼**ï¼šç”± `test_recognize2()` è‡ªå‹•ç”Ÿæˆ

---

## ğŸ”§ è‡ªå‹•ç”Ÿæˆçš„è©æ³•åˆ†æå™¨

### `a.ml`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6.1 é¡Œ
- **æ­£å‰‡è¡¨é”å¼**ï¼š`a*b`
- **ç”Ÿæˆæ–¹å¼**ï¼šç”± `generate` å‡½æ•¸è‡ªå‹•ç”Ÿæˆ
- **å…§å®¹**ï¼š
  ```ocaml
  type buffer = { ... }
  let next_char b = ...
  let rec state0 b = ...  (* éæ¥å—ç‹€æ…‹ *)
  and state1 b = ...      (* æ¥å—ç‹€æ…‹ï¼ŒåŒ…å« # *)
  let start = state0
  ```

### `alternating.ml`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6 é¡Œæ“´å±•
- **æ­£å‰‡è¡¨é”å¼**ï¼š`(b|Îµ)(ab)*(a|Îµ)` - äº¤æ›¿ a å’Œ b çš„å­—ä¸²
- **ç”Ÿæˆæ–¹å¼**ï¼šç”± `test_alternating.ml` ç”Ÿæˆ
- **ç‰¹é»**ï¼šå¯ä»¥è­˜åˆ¥ç©ºå­—ä¸²

---

## ğŸ§‘â€ğŸ’» æ¸¬è©¦ç¨‹åº

### `lexer.ml`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6.2 é¡Œ
- **åŠŸèƒ½**ï¼šæ¸¬è©¦ `a.ml` ç”Ÿæˆçš„è©æ³•åˆ†æå™¨
- **ä½¿ç”¨æ–¹å¼**ï¼š
  ```bash
  wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml lexer.ml <è¼¸å…¥å­—ä¸²>"
  ```
- **æ¸¬è©¦ç¯„ä¾‹**ï¼š

  **æˆåŠŸæ¡ˆä¾‹** (`abbaaab`):
  ```
  --> "ab"
  --> "b"
  --> "aaab"
  Success
  ```

  **éƒ¨åˆ†æˆåŠŸ** (`aba`):
  ```
  --> "ab"
  Success
  ```

  **è©æ³•éŒ¯èª¤** (`aac`):
  ```
  exception Failure("lexical error")
  ```

### `lexer_alt.ml`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6 é¡Œæ“´å±•
- **åŠŸèƒ½**ï¼šæ¸¬è©¦ `alternating.ml` ç”Ÿæˆçš„è©æ³•åˆ†æå™¨
- **ä½¿ç”¨æ–¹å¼**ï¼š
  ```bash
  wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml lexer_alt.ml <è¼¸å…¥å­—ä¸²>"
  ```
- **æ¸¬è©¦ç¯„ä¾‹** (`abbac`):
  ```
  --> "ab"
  --> "ba"
  --> ""
  would now loop
  ```
  ï¼ˆç©ºå­—ä¸²æœƒå°è‡´ç„¡é™å¾ªç’°ï¼Œæ‰€ä»¥ç¨‹åºåœæ­¢ï¼‰

### `test_alternating.ml`
- **å°æ‡‰é¡Œç›®**ï¼šç¬¬ 6 é¡Œè¼”åŠ©
- **åŠŸèƒ½**ï¼šç”Ÿæˆ `alternating.ml`
- **ä½¿ç”¨æ–¹å¼**ï¼š
  ```bash
  wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml test_alternating.ml"
  ```

---

## ğŸ“š æ–‡æª”æ–‡ä»¶

### `README.md`
- **å…§å®¹**ï¼šä½œæ¥­çš„å®Œæ•´èªªæ˜ï¼ˆå¾ PDF è½‰æ›è€Œä¾†ï¼‰
- **åŒ…å«**ï¼šæ¯ä¸€é¡Œçš„é¡Œç›®æè¿°ã€æ¸¬è©¦æ¡ˆä¾‹ã€ç¯„ä¾‹ä»£ç¢¼

### `assignment03.pdf`
- **å…§å®¹**ï¼šåŸå§‹ä½œæ¥­ PDF
- **ä¾†æº**ï¼šè€å¸«æä¾›çš„ä½œæ¥­èªªæ˜

---

## ğŸ“‹ åŸ·è¡Œé †åºå»ºè­°

1. **é‹è¡Œä¸»ç¨‹åº**ï¼ˆæ¸¬è©¦æ‰€æœ‰é¡Œç›®ï¼‰ï¼š
   ```bash
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml Parser.ml"
   ```
   é€™æœƒé‹è¡Œæ‰€æœ‰æ¸¬è©¦ä¸¦ç”Ÿæˆ `autom.dot`, `autom2.dot`, `a.ml`

2. **ç”Ÿæˆå¯è¦–åŒ–åœ–ç‰‡**ï¼ˆéœ€è¦å…ˆå®‰è£ Graphvizï¼‰ï¼š
   ```bash
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && dot -Tpdf autom.dot > autom.pdf"
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && dot -Tpdf autom2.dot > autom2.pdf"
   ```

3. **æ¸¬è©¦è©æ³•åˆ†æå™¨**ï¼š
   ```bash
   # æ¸¬è©¦ a*b
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml lexer.ml abbaaab"

   # æ¸¬è©¦äº¤æ›¿ a/b
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml test_alternating.ml"
   wsl bash -c "cd /mnt/f/CompilerHW/HW3 && ocaml lexer_alt.ml abbac"
   ```

---

## ğŸ¯ é¡Œç›®ç¸½è¦½è¡¨

| é¡Œç›® | å‡½æ•¸/åŠŸèƒ½ | ä¸»è¦æ–‡ä»¶ | è¼¸å‡ºæ–‡ä»¶ | æ¸¬è©¦æ–‡ä»¶ |
|------|-----------|----------|----------|----------|
| 1 | `null` | Parser.ml (13-28) | - | Parser.ml (96-104) |
| 2 | `first`, `last` | Parser.ml (31-62) | - | Parser.ml (107-130) |
| 3 | `follow` | Parser.ml (67-93) | - | Parser.ml (132-148) |
| 4.1 | `next_state` | Parser.ml (168-175) | - | - |
| 4.2 | `make_dfa` | Parser.ml (178-221) | autom.dot | Parser.ml (276-287) |
| 4 | å¯è¦–åŒ– | Parser.ml (220-251) | autom.pdf | - |
| 5 | `recognize` | Parser.ml (254-273) | autom2.dot | Parser.ml (290-343) |
| 6.1 | `generate` | Parser.ml (348-470) | a.ml | Parser.ml (427-431) |
| 6.2 | è©æ³•åˆ†æå™¨ | lexer.ml | - | æ‰‹å‹•æ¸¬è©¦ |
| æ“´å±• | äº¤æ›¿ a/b | test_alternating.ml | alternating.ml | lexer_alt.ml |

---

## âœ… å®Œæˆç‹€æ…‹

- âœ… **ç¬¬ 1 é¡Œ**ï¼š`null` å‡½æ•¸ - æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… **ç¬¬ 2 é¡Œ**ï¼š`first`, `last` å‡½æ•¸ - æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… **ç¬¬ 3 é¡Œ**ï¼š`follow` å‡½æ•¸ - æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… **ç¬¬ 4 é¡Œ**ï¼šDFA æ§‹å»º + å¯è¦–åŒ– - ç”Ÿæˆçš„åœ–å½¢èˆ‡è€å¸«ç¯„ä¾‹ä¸€è‡´
- âœ… **ç¬¬ 5 é¡Œ**ï¼š`recognize` å‡½æ•¸ - æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… **ç¬¬ 6 é¡Œ**ï¼šè©æ³•åˆ†æå™¨ç”Ÿæˆ - æ‰€æœ‰æ¸¬è©¦é€šé

**æ‰€æœ‰åŠŸèƒ½å®Œæ•´å¯¦ä½œï¼Œæ‰€æœ‰æ¸¬è©¦é€šéï¼** ğŸ‰
